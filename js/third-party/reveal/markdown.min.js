!function(e,t){"function"==typeof define&&define.amd?(e.marked=require("./marked"),e.RevealMarkdown=t(e.marked),e.RevealMarkdown.initialize()):"object"==typeof exports?module.exports=t(require("./marked")):(e.RevealMarkdown=t(e.marked),e.RevealMarkdown.initialize())}(this,function(o){function s(e){var t=(e.querySelector("[data-template]")||e.querySelector("script")||e).textContent,a=(t=t.replace(new RegExp(i,"g"),"<\/script>")).match(/^\n?(\s*)/)[1].length,r=t.match(/^\n?(\t*)/)[1].length;return 0<r?t=t.replace(new RegExp("\\n?\\t{"+r+"}","g"),"\n"):1<a&&(t=t.replace(new RegExp("\\n? {"+a+"}","g"),"\n")),t}function l(e){for(var t=e.attributes,a=[],r=0,n=t.length;r<n;r++){var i=t[r].name,o=t[r].value;/data\-(markdown|separator|vertical|notes)/gi.test(i)||(o?a.push(i+'="'+o+'"'):a.push(i))}return a.join(" ")}function h(e){return(e=e||{}).separator=e.separator||r,e.notesSeparator=e.notesSeparator||n,e.attributes=e.attributes||"",e}function m(e,t){t=h(t);var a=e.split(new RegExp(t.notesSeparator,"mgi"));return 2===a.length&&(e=a[0]+'<aside class="notes">'+o(a[1].trim())+"</aside>"),'<script type="text/template">'+(e=e.replace(/<\/script>/g,i))+"<\/script>"}function d(e,t){t=h(t);for(var a,r,n,i=new RegExp(t.separator+(t.verticalSeparator?"|"+t.verticalSeparator:""),"mg"),o=new RegExp(t.separator),s=0,l=!0,d=[];a=i.exec(e);)notes=null,!(r=o.test(a[0]))&&l&&d.push([]),n=e.substring(s,a.index),r&&l?d.push(n):d[d.length-1].push(n),s=i.lastIndex,l=r;(l?d:d[d.length-1]).push(e.substring(s));for(var u="",c=0,p=d.length;c<p;c++)d[c]instanceof Array?(u+="<section "+t.attributes+">",d[c].forEach(function(e){u+="<section data-markdown>"+m(e,t)+"</section>"}),u+="</section>"):u+="<section "+t.attributes+" data-markdown>"+m(d[c],t)+"</section>";return u}function t(){for(var e,t=document.querySelectorAll("[data-markdown]"),a=0,r=t.length;a<r;a++)if((e=t[a]).getAttribute("data-markdown").length){var n=new XMLHttpRequest,i=e.getAttribute("data-markdown");datacharset=e.getAttribute("data-charset"),null!=datacharset&&""!=datacharset&&n.overrideMimeType("text/html; charset="+datacharset),n.onreadystatechange=function(){4===n.readyState&&(200<=n.status&&n.status<300||0===n.status?e.outerHTML=d(n.responseText,{separator:e.getAttribute("data-separator"),verticalSeparator:e.getAttribute("data-separator-vertical"),notesSeparator:e.getAttribute("data-separator-notes"),attributes:l(e)}):e.outerHTML='<section data-state="alert">ERROR: The attempt to fetch '+i+" failed with HTTP status "+n.status+".Check your browser's JavaScript console for more details.<p>Remember that you need to serve the presentation HTML from a HTTP server.</p></section>")},n.open("GET",i,!1);try{n.send()}catch(e){alert("Failed to get the Markdown file "+i+". Make sure that the presentation and the file are served by a HTTP server and the file can be found there. "+e)}}else e.getAttribute("data-separator")||e.getAttribute("data-separator-vertical")||e.getAttribute("data-separator-notes")?e.outerHTML=d(s(e),{separator:e.getAttribute("data-separator"),verticalSeparator:e.getAttribute("data-separator-vertical"),notesSeparator:e.getAttribute("data-separator-notes"),attributes:l(e)}):e.innerHTML=m(s(e))}function u(e,t,a){var r=new RegExp(a,"mg"),n=new RegExp('([^"= ]+?)="([^"=]+?)"',"mg"),i=e.nodeValue;if(matches=r.exec(i)){var o=matches[1];for(i=i.substring(0,matches.index)+i.substring(r.lastIndex),e.nodeValue=i;matchesClass=n.exec(o);)t.setAttribute(matchesClass[1],matchesClass[2]);return!0}return!1}function c(e,t,a,r,n){if(null!=t&&null!=t.childNodes&&0<t.childNodes.length){previousParentElement=t;for(var i=0;i<t.childNodes.length;i++){if(childElement=t.childNodes[i],0<i)for(j=i-1;0<=j;){if(aPreviousChildElement=t.childNodes[j],"function"==typeof aPreviousChildElement.setAttribute&&"BR"!=aPreviousChildElement.tagName){previousParentElement=aPreviousChildElement;break}j-=1}parentSection=e,"section"==childElement.nodeName&&(parentSection=childElement,previousParentElement=childElement),"function"!=typeof childElement.setAttribute&&childElement.nodeType!=Node.COMMENT_NODE||c(parentSection,childElement,previousParentElement,r,n)}}t.nodeType==Node.COMMENT_NODE&&0==u(t,a,r)&&u(t,e,n)}function a(){for(var e=document.querySelectorAll("[data-markdown]"),t=0,a=e.length;t<a;t++){var r=e[t];if(!r.getAttribute("data-markdown-parsed")){r.setAttribute("data-markdown-parsed",!0);var n=r.querySelector("aside.notes"),i=s(r);r.innerHTML=o(i),c(r,r,null,r.getAttribute("data-element-attributes")||r.parentNode.getAttribute("data-element-attributes")||"\\.element\\s*?(.+?)$",r.getAttribute("data-attributes")||r.parentNode.getAttribute("data-attributes")||"\\.slide:\\s*?(\\S.+?)$"),n&&r.appendChild(n)}}}var r="^\r?\n---\r?\n$",n="notes?:",i="__SCRIPT_END__";return{initialize:function(){if(void 0===o)throw"The reveal.js Markdown plugin requires marked to be loaded";"undefined"!=typeof hljs&&o.setOptions({highlight:function(e,t){return hljs.highlightAuto(e,[t]).value}});var e=Reveal.getConfig().markdown;e&&o.setOptions(e),t(),a()},processSlides:t,convertSlides:a,slidify:d}});